# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Arduino –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Arduino –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∫–∞—Ñ–æ–º (–æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —è—á–µ–µ–∫, –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞, –∑–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã).

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

1. **IArduino.cs** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Arduino
2. **ArduinoSerial.cs** - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ COM –ø–æ—Ä—Ç (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è)
3. **ArduinoNull.cs** - –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –∂–µ–ª–µ–∑–∞
4. **ArduinoClientSerial** (–≤ Devices.cs) - –æ—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤ MainForm

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (App.config)

```xml
<!-- –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å Arduino -->
<add key="EnableArduino" value="true" />

<!-- COM –ø–æ—Ä—Ç Arduino -->
<add key="ArduinoPort" value="COM10" />

<!-- –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ (–æ–±—ã—á–Ω–æ 115200 –∏–ª–∏ 9600) -->
<add key="BaudArduino" value="115200" />

<!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Å—Ç—Ä–æ–∫ (–æ–±—ã—á–Ω–æ \n –∏–ª–∏ \r\n) -->
<add key="NewLineArduino" value="&#10;" />

<!-- –í–ê–ñ–ù–û: DTR –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å false –¥–ª—è Arduino, –∏–Ω–∞—á–µ –æ–Ω –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ—Ä—Ç–∞ -->
<add key="ArduinoDtr" value="false" />
<add key="ArduinoRts" value="false" />

<!-- –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–∞ (–º—Å) - –¥–∞—ë—Ç Arduino –≤—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è -->
<add key="ArduinoOpenDelayMs" value="2000" />

<!-- –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥—ã (–º—Å) - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ -->
<add key="ArduinoCommandDelayMs" value="50" />

<!-- –¢–∞–π–º–∞—É—Ç—ã -->
<add key="ReadTimeoutMs" value="5000" />
<add key="WriteTimeoutMs" value="1000" />
<add key="AutoReconnectMs" value="3000" />
```

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ Arduino

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é SerialPort –≤–∫–ª—é—á–∞–µ—Ç DTR (Data Terminal Ready), –∫–æ—Ç–æ—Ä—ã–π —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç Arduino –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ—Ä—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. **`ArduinoDtr = false`** - –æ—Ç–∫–ª—é—á–∞–µ—Ç DTR, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É
2. **`ArduinoRts = false`** - –æ—Ç–∫–ª—é—á–∞–µ—Ç RTS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. **`ArduinoOpenDelayMs = 2000`** - –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–∞ (–¥–∞—ë—Ç Arduino –≤—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è)
4. **`ArduinoCommandDelayMs = 50`** - –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞)

–ï—Å–ª–∏ Arduino –≤—Å—ë –µ—â—ë –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
- –£–≤–µ–ª–∏—á—å—Ç–µ `ArduinoOpenDelayMs` –¥–æ 3000-5000 –º—Å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ Arduino (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Ç–æ–∫ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Å–±—Ä–æ—Å—ã)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π USB-–∫–∞–±–µ–ª—å

## –ö–æ–º–∞–Ω–¥—ã Arduino

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (—Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –æ—Ç–≤–µ—Ç–∞)

#### 1. `SPACE?`
**–û—Ç–ø—Ä–∞–≤–∫–∞:** `SPACE?`  
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** `SPACE:1` –∏–ª–∏ `SPACE:0` (–∏–ª–∏ `SPACE=1`, `SPACE 1`)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ —à–∫–∞—Ñ—É  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∫–Ω–∏–≥–∏ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º —è—á–µ–π–∫–∏

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ Arduino:**
```cpp
if (Serial.available() > 0) {
    String cmd = Serial.readStringUntil('\n');
    cmd.trim();
    
    if (cmd == "SPACE?") {
        bool hasSpace = checkSpace(); // –≤–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        Serial.println(hasSpace ? "SPACE:1" : "SPACE:0");
    }
}
```

#### 2. `OPENBIN`
**–û—Ç–ø—Ä–∞–≤–∫–∞:** `OPENBIN`  
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** `OK` (–≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–∫—Ä—ã—Ç–∏–µ —è—á–µ–π–∫–∏ —à–∫–∞—Ñ–∞  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤—ã–¥–∞—á–∏ –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–∏–≥–∏

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ Arduino:**
```cpp
if (cmd == "OPENBIN") {
    openBin(); // –≤–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è —è—á–µ–π–∫–∏
    delay(100); // –Ω–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ –º–µ—Ö–∞–Ω–∏–∫—É
    Serial.println("OK");
}
```

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞)

#### 3. `OK`
**–û—Ç–ø—Ä–∞–≤–∫–∞:** `OK`  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∏–≥–Ω–∞–ª —É—Å–ø–µ—à–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤—ã–¥–∞—á–∏/–≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–∏–≥–∏

#### 4. `ERR`
**–û—Ç–ø—Ä–∞–≤–∫–∞:** `ERR`  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∏–≥–Ω–∞–ª –æ—à–∏–±–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–Ω–µ–≤–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞, –∫–Ω–∏–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏ —Ç.–¥.)

#### 5. `BEEP:120`
**–û—Ç–ø—Ä–∞–≤–∫–∞:** `BEEP:120` (–≥–¥–µ 120 - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)  
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –ë–∏–Ω–∞—Ä–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∫–∞—Ñ–æ–º (8 –±–∞–π—Ç)

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –∞–¥—Ä–µ—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —è—á–µ–π–∫–∞–º–∏ —à–∫–∞—Ñ–∞. –§–æ—Ä–º–∞—Ç –ø–∞–∫–µ—Ç–∞: `FF, CMD, fromX, fromY, toX, toY, sizeX, sizeY` (8 –±–∞–π—Ç).

#### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **`INIT` (0x00)** - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —à–∫–∞—Ñ–∞
   ```csharp
   _ardu.Init(fromX, fromY, toX, toY, sizeX, sizeY);
   ```

2. **`GIVEFRONT` (0x02)** - –í—ã–¥–∞—á–∞ –∫–Ω–∏–≥–∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω—é—é —Å—Ç–æ—Ä–æ–Ω—É
   ```csharp
   _ardu.GiveFront(fromX, fromY, toX, toY, sizeX, sizeY);
   ```

3. **`TAKEFRONT` (0x03)** - –í–∑—è—Ç–∏–µ –∫–Ω–∏–≥–∏ —Å –ø–µ—Ä–µ–¥–Ω–µ–π —Å—Ç–æ—Ä–æ–Ω—ã
   ```csharp
   _ardu.TakeFront(fromX, fromY, toX, toY, sizeX, sizeY);
   ```

4. **`GIVEBACK` (0x04)** - –í—ã–¥–∞—á–∞ –∫–Ω–∏–≥–∏ –Ω–∞ –∑–∞–¥–Ω—é—é —Å—Ç–æ—Ä–æ–Ω—É
   ```csharp
   _ardu.GiveBack(fromX, fromY, toX, toY, sizeX, sizeY);
   ```

5. **`TAKEBACK` (0x05)** - –í–∑—è—Ç–∏–µ –∫–Ω–∏–≥–∏ —Å –∑–∞–¥–Ω–µ–π —Å—Ç–æ—Ä–æ–Ω—ã
   ```csharp
   _ardu.TakeBack(fromX, fromY, toX, toY, sizeX, sizeY);
   ```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `fromX`, `fromY` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ (0-254)
- `toX`, `toY` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–ª–µ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ (0-254)
- `sizeX`, `sizeY` - —Ä–∞–∑–º–µ—Ä—ã —Å–µ—Ç–∫–∏ —è—á–µ–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3x22)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```csharp
// –ö–æ–º–∞–Ω–¥–∞ TAKEFRONT –∏–∑ control-fulltest.bat:
// control COM8 TAKEFRONT 1 9 0 0 3 22
_ardu.TakeFront(fromX: 1, fromY: 9, toX: 0, toY: 0, sizeX: 3, sizeY: 22);

// –ö–æ–º–∞–Ω–¥–∞ GIVEFRONT:
// control COM8 GIVEFRONT 0 0 1 9 3 22
_ardu.GiveFront(fromX: 0, fromY: 0, toX: 1, toY: 9, sizeX: 3, sizeY: 22);
```

**–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Arduino:**
```cpp
void loop() {
    if (Serial.available() >= 8) {
        byte packet[8];
        Serial.readBytes(packet, 8);
        
        if (packet[0] == 0xFF) {  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ –±–∞–π—Ç–∞
            byte cmd = packet[1];
            byte fromX = packet[2];
            byte fromY = packet[3];
            byte toX = packet[4];
            byte toY = packet[5];
            byte sizeX = packet[6];
            byte sizeY = packet[7];
            
            switch (cmd) {
                case 0x00: // INIT
                    initializeCabinet(fromX, fromY, toX, toY, sizeX, sizeY);
                    break;
                case 0x02: // GIVEFRONT
                    giveFront(fromX, fromY, toX, toY, sizeX, sizeY);
                    break;
                case 0x03: // TAKEFRONT
                    takeFront(fromX, fromY, toX, toY, sizeX, sizeY);
                    break;
                case 0x04: // GIVEBACK
                    giveBack(fromX, fromY, toX, toY, sizeX, sizeY);
                    break;
                case 0x05: // TAKEBACK
                    takeBack(fromX, fromY, toX, toY, sizeX, sizeY);
                    break;
            }
        }
    }
}
```

## –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –∫–æ–¥–∞ Arduino

```cpp
void setup() {
    Serial.begin(115200);
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∏–Ω–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∫–∞—Ñ–æ–º
    pinMode(LED_BUILTIN, OUTPUT);
    // ... –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}

void loop() {
    if (Serial.available() > 0) {
        String cmd = Serial.readStringUntil('\n');
        cmd.trim();
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        if (cmd == "SPACE?") {
            bool hasSpace = checkSpace();
            Serial.println(hasSpace ? "SPACE:1" : "SPACE:0");
        }
        else if (cmd == "OPENBIN") {
            openBin();
            delay(100);
            Serial.println("OK");
        }
        // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å)
        else if (cmd == "OK") {
            // –°–∏–≥–Ω–∞–ª —É—Å–ø–µ—Ö–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        }
        else if (cmd == "ERR") {
            // –°–∏–≥–Ω–∞–ª –æ—à–∏–±–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        }
        else if (cmd.startsWith("BEEP:")) {
            int duration = cmd.substring(5).toInt();
            beep(duration);
        }
    }
}

bool checkSpace() {
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–µ—Å—Ç–∞
    // –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—á–∏–∫–∞ –∏–ª–∏ —Å—á–µ—Ç—á–∏–∫–∞
    return true; // –∏–ª–∏ false
}

void openBin() {
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —è—á–µ–π–∫–∏
    // –ù–∞–ø—Ä–∏–º–µ—Ä, –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–∞ –∏–ª–∏ —Ä–µ–ª–µ
    digitalWrite(LED_BUILTIN, HIGH);
    delay(2000); // –≤—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è
    digitalWrite(LED_BUILTIN, LOW);
}

void beep(int duration) {
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–≤—É–∫–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
    // –ù–∞–ø—Ä–∏–º–µ—Ä, tone(pin, frequency, duration)
    tone(8, 1000, duration); // –ø–∏–Ω 8, —á–∞—Å—Ç–æ—Ç–∞ 1000 –ì—Ü
}
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∏ –æ—Ç–≤–µ—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `Logs/arduino.log`:
- `>>` - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `<<` - –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- `OPENED` / `CLOSED` - —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## –û—Ç–ª–∞–¥–∫–∞

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ COM –ø–æ—Ä—Ç —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ `App.config`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ (–¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å Arduino)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Å—Ç—Ä–æ–∫ (`\n` –∏–ª–∏ `\r\n`)

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–∞–Ω–¥:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `Logs/arduino.log` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Serial Monitor –≤ Arduino IDE –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –∂–µ–ª–µ–∑–∞:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `EnableArduino` –≤ `false` - –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ArduinoNull` –∫–ª–∞—Å—Å –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ Arduino

### –°–∏–º–ø—Ç–æ–º—ã
- Arduino –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥
- –°–≤–µ—Ç–æ–¥–∏–æ–¥ –Ω–∞ Arduino –º–∏–≥–∞–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥–µ
- –ö–æ–º–∞–Ω–¥—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏–ª–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –ü—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### 1. **DTR —Å–∏–≥–Ω–∞–ª —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç Arduino** (–Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞)
**–ü—Ä–æ–±–ª–µ–º–∞:** SerialPort –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–∞–µ—Ç DTR, –∫–æ—Ç–æ—Ä—ã–π —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç Arduino –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ—Ä—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ `App.config`:
```xml
<add key="ArduinoDtr" value="false" />
<add key="ArduinoRts" value="false" />
```

#### 2. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–∞**
**–ü—Ä–æ–±–ª–µ–º–∞:** Arduino –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É:
```xml
<add key="ArduinoOpenDelayMs" value="2000" />
<!-- –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ 3000-5000 -->
```

#### 3. **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–∞–Ω–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ, –±—É—Ñ–µ—Ä –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏:
```xml
<add key="ArduinoCommandDelayMs" value="50" />
<!-- –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 100-200, –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è -->
```

#### 4. **–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∏—Ç–∞–Ω–∏–µ–º**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Ç–æ–∫ —á–µ—Ä–µ–∑ USB –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Å–±—Ä–æ—Å—ã.

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π USB-–∫–∞–±–µ–ª—å
- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Arduino –∫ –æ—Ç–¥–µ–ª—å–Ω–æ–º—É USB-–ø–æ—Ä—Ç—É (–Ω–µ —á–µ—Ä–µ–∑ USB-—Ö–∞–±)
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–Ω–µ—à–Ω–µ–µ –ø–∏—Ç–∞–Ω–∏–µ –¥–ª—è Arduino

#### 5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª–æ–≥–∞—Ö**
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `Logs/arduino.log`:
```
CONFIG: DTR=false, RTS=false  ‚Üê –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å false
OPENED (Arduino ready)        ‚Üê –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏
>> BIN TAKEFRONT: ...         ‚Üê –∫–æ–º–∞–Ω–¥—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `DTR=true` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `App.config`.

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–∞–π–º–∞—É—Ç—ã:**
   - `SPACE?` –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ `ReadTimeoutMs` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5 —Å–µ–∫—É–Ω–¥)
   - `OPENBIN` –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ `ReadTimeoutMs + 10000` (15 —Å–µ–∫—É–Ω–¥)

2. **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤:**
   - –û—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è —Å–∏–º–≤–æ–ª–æ–º –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (`\n` –∏–ª–∏ `\r\n`)
   - –î–ª—è `SPACE?` —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã: `SPACE:1`, `SPACE=1`, `SPACE 1`, `1`
   - –î–ª—è `OPENBIN` —Å–∏—Å—Ç–µ–º–∞ –æ–∂–∏–¥–∞–µ—Ç —Ç–æ—á–Ω–æ `OK`

3. **–ê–≤—Ç–æ–ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
   - –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è —á–µ—Ä–µ–∑ `AutoReconnectMs` (3 —Å–µ–∫—É–Ω–¥—ã)

## –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö Arduino

### Arduino Uno/Nano (9600 –±–æ–¥)
```xml
<add key="BaudArduino" value="9600" />
<add key="ArduinoPort" value="COM3" />
```

### Arduino Mega/ESP32 (115200 –±–æ–¥)
```xml
<add key="BaudArduino" value="115200" />
<add key="ArduinoPort" value="COM10" />
```

### –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `PortResolver` —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `auto:`:
```xml
<add key="ArduinoPort" value="auto:VID_2341&PID_0043" />
```

